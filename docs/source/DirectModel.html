<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>The source code</title>
  <link href="../resources/prettify/prettify.css" type="text/css" rel="stylesheet" />
  <script type="text/javascript" src="../resources/prettify/prettify.js"></script>
  <style type="text/css">
    .highlight { display: block; background-color: #ddd; }
  </style>
  <script type="text/javascript">
    function highlight() {
      document.getElementById(location.hash.replace(/#/, "")).className = "highlight";
    }
  </script>
</head>
<body onload="prettyPrint(); highlight();">
  <pre class="prettyprint lang-js"><span id='Hatimeria-core-model-DirectModel'>/**
</span> * Direct model
 * @example
 *     Ext.define(&quot;Foo.BarModel&quot;, {
 *      extend: 'Hatimeria.core.model.DirectModel'
 *      fields: ['id','name'],
 *      api: 'FooBundle_BarController'
 *     });
 * 
 * @class Hatimeria.core.model.DirectModel
 * @extends Ext.data.Model
 */
Ext.define(&quot;Hatimeria.core.model.DirectModel&quot;, {
    extend: 'Ext.data.Model',
    requires: ['Hatimeria.core.mixins.ConfigurableExternal'],
    
    onClassExtended: function(cls, data) {
        
        if(!data.idProperty) {
            data.idProperty = typeof data.fields[0] == 'string' ? data.fields[0] : data.fields[0].name;
        }
        
        if (typeof data.api == 'string') {
            var controller = data.api;
            data.api = {
                update: Actions[controller].update,
                destroy: Actions[controller].destroy,
                create: Actions[controller].create,
                read: Actions[controller].read
            }
        }
        
        data.proxy = {
            type: 'direct',
            api: data.api,
            reader: {
                type: 'json',
                root: 'record',
                messageProperty: 'msg'
            }
        };
        
        delete data.api;
        
        // Adding extra fields:
        var ce = Ext.create(&quot;Hatimeria.core.mixins.ConfigurableExternal&quot;);
        var extraConfig = ce.getConnectedConfig(data.$className);
        
        Ext.each(extraConfig.fields, function(field) {
           data.fields.push(field);
        });
        
        cls.prototype.superclass.superclass.$onExtended(cls, data);
    }
});</pre>
</body>
</html>
